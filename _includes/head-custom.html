<!-- Fallback (shown if JS is disabled or fails) -->
<link rel="icon" href="/favicon.ico" sizes="any">

<!-- Dynamic pixel-art favicon: Tech Gold background, white A → L → I, slide-down transition -->
<script>
(function () {
  const GOLD = "#B3A369";   // Georgia Tech Tech Gold
  const WHITE = "#FFFFFF";

  // 8×8 pixel letters, scaled to 24×24 inside a 32×32 icon (padding keeps it crisp)
  const GRID = 8, SCALE = 3, SIZE = 32;
  const LETTER = GRID * SCALE;                     // 24
  const OFFSET = Math.floor((SIZE - LETTER) / 2);  // center letters (4px margin)

  // Pixel maps ('1' = white pixel)
  const A = [
    "00111100",
    "01000010",
    "10000001",
    "11111111",
    "10000001",
    "10000001",
    "10000001",
    "10000001"
  ];
  const L = [
    "10000000",
    "10000000",
    "10000000",
    "10000000",
    "10000000",
    "10000000",
    "11111111",
    "00000000"
  ];
  const I = [
    "11111111",
    "00011000",
    "00011000",
    "00011000",
    "00011000",
    "00011000",
    "11111111",
    "00000000"
  ];
  const FRAMES = [A, L, I];

  const HOLD_MS = 5000;  // how long each letter sits
  const SLIDE_MS = 320;  // slide duration

  // --- ensure a single <link rel="icon"> that we control ---
  let link = null;
  const icons = Array.from(document.querySelectorAll('link[rel*="icon"]'));
  if (icons.length) {
    link = icons[0];
    link.id = 'dynamic-favicon';
    link.type = 'image/png';
    // Remove any extra icon links so the browser doesn't prefer them
    icons.slice(1).forEach(el => el.parentNode.removeChild(el));
  } else {
    link = document.createElement('link');
    link.id = 'dynamic-favicon';
    link.rel = 'icon';
    link.type = 'image/png';
    document.head.appendChild(link);
  }

  // --- canvas setup ---
  const canvas = document.createElement('canvas');
  canvas.width = SIZE; canvas.height = SIZE;
  const ctx = canvas.getContext('2d', { alpha: true });
  ctx.imageSmoothingEnabled = false; // crisp pixels

  function drawMap(map, yOffset) {
    ctx.fillStyle = WHITE;
    for (let y = 0; y < GRID; y++) {
      const row = map[y];
      for (let x = 0; x < GRID; x++) {
        if (row[x] === '1') {
          ctx.fillRect(OFFSET + x * SCALE, OFFSET + y * SCALE + yOffset, SCALE, SCALE);
        }
      }
    }
  }

  function renderSlide(fromIdx, toIdx, t) {
    // Background gold
    ctx.clearRect(0, 0, SIZE, SIZE);
    ctx.fillStyle = GOLD;
    ctx.fillRect(0, 0, SIZE, SIZE);

    // Slide distance: slightly more than the letter height so the old letter exits fully
    const DIST = LETTER + 4;  // 28px
    const oldY = Math.round(DIST * t);           // move down
    const newY = Math.round(oldY - DIST);        // start above, slide in

    drawMap(FRAMES[fromIdx], oldY);
    drawMap(FRAMES[toIdx], newY);

    link.href = canvas.toDataURL('image/png');   // update favicon
  }

  // initial render
  let i = 0;
  renderSlide(0, 1, 0);

  function cycle() {
    const from = i;
    const to = (i + 1) % FRAMES.length;
    const start = performance.now();

    function step(now) {
      const t = Math.min(1, (now - start) / SLIDE_MS);
      renderSlide(from, to, t);
      if (t < 1) requestAnimationFrame(step);
      else { i = to; setTimeout(cycle, HOLD_MS); }
    }
    requestAnimationFrame(step);
  }

  setTimeout(cycle, HOLD_MS);
})();
</script>
